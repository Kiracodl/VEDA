
program attard_tester
  use Fractions

  integer p,q
  
  call fraction_limit_denominator( 3.141592653589793d0, 10, p, q)
  write(*,*) p, q
  call fraction_limit_denominator( 3.141592653589793d0, 100, p, q)
  write(*,*) p, q
  call fraction_limit_denominator( 6.2347d0 , 20, p, q)
  write(*,*) p, q
end program attard_tester
  
! program attard_tester
!   use NonDimensionalization
!   use Viscoelasticity_attard

! type(matl_prop) :: cur_props
! real*8 A_dim, Rtip_nd
! integer, parameter :: N_attard_spatial = 20
! real*8 :: u_cur(N_attard_spatial), u_dot(N_attard_spatial), d, dpr

! cur_props%N_attard_spatial = N_attard_spatial
! cur_props%fts_model = ATTARD_SPATIAL
! cur_props%VEchoice = VEC_THREEELM_E0_EINF_TAU !hack for testing
! cur_props%attard_radial_extent = 2.0

! A_dim = 1d-19
! Rtip_nd = 10d-9

! call set_a_scale(1d0)
! call set_omega_scale(1d0)

!  call initialize_attard( Rtip_nd, cur_props )

!  u_cur=[1.250438146439785e-10,1.111026564842232e-10,9.210138677081809e-11,7.43880982427563e-11,6.029656273790785e-11,4.970730212917854e-11,4.182887773317118e-11,3.590213661237026e-11,3.135638938774618e-11,2.779390274800627e-11,2.494296044822278e-11,2.261730660372879e-11,2.068750137837652e-11,1.906195042879477e-11, &
!       1.767456831309372e-11,1.64767431833504e-11,1.543204379274222e-11,1.451267185457046e-11,1.369701620016958e-11,1.296779555543533e-11]
 
!     d = 1.070920400318062e-09
!     dpr = -0.001561926599691102
    
!     u_dot = compute_attard_derivative(d, dpr, u_cur)
!     write(*,*) "u dot = ", u_dot
!     write(*,*) "Fts = ", Fts_attard_spatial(d, u_cur)  
    
! end program attard_tester

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1111
  
! program attard_tester
!   use NonDimensionalization
!   use Viscoelasticity_attard

! type(matl_prop) :: cur_props
! real*8 A_dim, Rtip_nd
! integer, parameter :: N_attard_spatial = 20
! integer, parameter :: n_time = 150
! real*8 :: u_cur(N_attard_spatial), u_dot(N_attard_spatial), d, dpr
! real*8 :: d_list(n_time), dpr_list(n_time)
! integer :: i
! real*8, parameter :: dt =  1.471064911127221e-08

! cur_props%N_attard_spatial = N_attard_spatial
! cur_props%fts_model = ATTARD_SPATIAL
! cur_props%VEchoice = VEC_THREEELM_E0_EINF_TAU !hack for testing
! cur_props%attard_radial_extent = 2.0

! A_dim = 1d-19
! Rtip_nd = 10d-9

! call set_a_scale(1d0)
! call set_omega_scale(1d0)

!  call initialize_attard( Rtip_nd, cur_props )

!  u_cur =0

! d_list = [5.000000000000002e-09,&
!   4.894871807126822e-09,&
!   4.790939966216313e-09,&
!   4.688213356368283e-09,&
!   4.586700753717295e-09,&
!   4.486410830682911e-09,&
!   4.387352155228793e-09,&
!   4.289533190130722e-09,&
!   4.1929622922536e-09,&
!   4.09764771183752e-09,&
!   4.003597591792924e-09,&
!   3.910819967004933e-09,&
!   3.819322763646934e-09,&
!   3.729113798503382e-09,&
!   3.640200778302059e-09,&
!   3.55259129905564e-09,&
!   3.466292845412745e-09,&
!   3.381312790018527e-09,&
!   3.297658392884805e-09,&
!   3.215336800769825e-09,&
!   3.134355046567705e-09,&
!   3.054720048707597e-09,&
!   2.97643861056263e-09,&
!   2.899517419868694e-09,&
!   2.823963048153086e-09,&
!   2.749781950173083e-09,&
!   2.676980463364522e-09,&
!   2.605564807300362e-09,&
!   2.535541083159342e-09,&
!   2.466915273204734e-09,&
!   2.39969324027329e-09,&
!   2.333880727274341e-09,&
!   2.26948335669919e-09,&
!   2.20650663014076e-09,&
!   2.144955927823588e-09,&
!   2.08483650814418e-09,&
!   2.026153507221769e-09,&
!   1.96891193845954e-09,&
!   1.913116692116321e-09,&
!   1.858772534888793e-09,&
!   1.805884109504253e-09,&
!   1.754455934324004e-09,&
!   1.704492402957324e-09,&
!   1.655997783886106e-09,&
!   1.608976220100211e-09,&
!   1.563431728743513e-09,&
!   1.519368200770701e-09,&
!   1.476789400614886e-09,&
!   1.435698965865979e-09,&
!   1.396100406959938e-09,&
!   1.357997106878849e-09,&
!   1.321392320861935e-09,&
!   1.28628917612743e-09,&
!   1.252690671605431e-09,&
!   1.220599677681689e-09,&
!   1.190018935952377e-09,&
!   1.16095105898989e-09,&
!   1.133398530119622e-09,&
!   1.107363703207846e-09,&
!   1.082848802460576e-09,&
!   1.059855922233585e-09,&
!   1.038387026853456e-09,&
!   1.018443950449782e-09,&
!   1.000028396798462e-09,&
!   9.831419391761475e-10,&
!   9.677860202258402e-10,&
!   9.539619518336345e-10,&
!   9.416709150166455e-10,&
!   9.309139598221131e-10,&
!   9.216920052376921e-10,&
!   9.140058391129401e-10,&
!   9.078561180920209e-10,&
!   9.032433675575857e-10,&
!   9.001679815859094e-10,&
!   8.986302229132122e-10,&
!   8.986302229132122e-10,&
!   9.001679815859094e-10,&
!   9.032433675575857e-10,&
!   9.078561180920209e-10,&
!   9.140058391129401e-10,&
!   9.216920052376921e-10,&
!   9.309139598221131e-10,&
!   9.416709150166455e-10,&
!   9.539619518336345e-10,&
!   9.677860202258402e-10,&
!   9.831419391761475e-10,&
!   1.000028396798462e-09,&
!   1.018443950449779e-09,&
!   1.038387026853456e-09,&
!   1.059855922233585e-09,&
!   1.082848802460576e-09,&
!   1.107363703207846e-09,&
!   1.133398530119622e-09,&
!   1.160951058989886e-09,&
!   1.190018935952377e-09,&
!   1.220599677681686e-09,&
!   1.252690671605431e-09,&
!   1.28628917612743e-09,&
!   1.321392320861935e-09,&
!   1.357997106878849e-09,&
!   1.396100406959938e-09,&
!   1.435698965865979e-09,&
!   1.476789400614886e-09,&
!   1.519368200770701e-09,&
!   1.56343172874351e-09,&
!   1.608976220100208e-09,&
!   1.655997783886106e-09,&
!   1.704492402957321e-09,&
!   1.754455934324e-09,&
!   1.80588410950425e-09,&
!   1.85877253488879e-09,&
!   1.913116692116321e-09,&
!   1.96891193845954e-09,&
!   2.026153507221769e-09,&
!   2.08483650814418e-09,&
!   2.144955927823588e-09,&
!   2.20650663014076e-09,&
!   2.26948335669919e-09,&
!   2.333880727274341e-09,&
!   2.39969324027329e-09,&
!   2.466915273204734e-09,&
!   2.535541083159339e-09,&
!   2.605564807300359e-09,&
!   2.676980463364525e-09,&
!   2.749781950173083e-09,&
!   2.823963048153086e-09,&
!   2.899517419868694e-09,&
!   2.976438610562627e-09,&
!   3.054720048707591e-09,&
!   3.134355046567702e-09,&
!   3.215336800769821e-09,&
!   3.297658392884802e-09,&
!   3.381312790018527e-09,&
!   3.466292845412745e-09,&
!   3.55259129905564e-09,&
!   3.640200778302063e-09,&
!   3.729113798503379e-09,&
!   3.81932276364693e-09,&
!   3.910819967004937e-09,&
!   4.003597591792925e-09,&
!   4.097647711837522e-09,&
!   4.192962292253599e-09,&
!   4.289533190130717e-09,&
!   4.387352155228791e-09,&
!   4.486410830682908e-09,&
!   4.586700753717291e-09,&
!   4.688213356368281e-09,&
!   4.790939966216318e-09,&
!   4.894871807126823e-09,&
!   5e-09 ]
 
! dpr_list = [ -0.007186860536539874,&
!   -0.007105839075745872,&
!   -0.007024210549265349,&
!   -0.006941981930782467,&
!   -0.006859160245248428,&
!   -0.006775752568281302,&
!   -0.006691766025561554,&
!   -0.006607207792223278,&
!   -0.006522085092241211,&
!   -0.006436405197813575,&
!   -0.006350175428740805,&
!   -0.006263403151800191,&
!   -0.006176095780116541,&
!   -0.006088260772528831,&
!   -0.00599990563295301,&
!   -0.005911037909740928,&
!   -0.005821665195035443,&
!   -0.005731795124121818,&
!   -0.005641435374775435,&
!   -0.005550593666605854,&
!   -0.005459277760397318,&
!   -0.005367495457445735,&
!   -0.005275254598892193,&
!   -0.00518256306505308,&
!   -0.005089428774746855,&
!   -0.004995859684617518,&
!   -0.00490186378845488,&
!   -0.004807449116511609,&
!   -0.004712623734817209,&
!   -0.004617395744488922,&
!   -0.004521773281039626,&
!   -0.004425764513682811,&
!   -0.00432937764463466,&
!   -0.004232620908413321,&
!   -0.004135502571135417,&
!   -0.004038030929809855,&
!   -0.003940214311628987,&
!   -0.003842061073257229,&
!   -0.003743579600117099,&
!   -0.003644778305672864,&
!   -0.003545665630711729,&
!   -0.003446250042622764,&
!   -0.003346540034673489,&
!   -0.003246544125284288,&
!   -0.003146270857300663,&
!   -0.003045728797263401,&
!   -0.002944926534676719,&
!   -0.002843872681274443,&
!   -0.002742575870284294,&
!   -0.002641044755690336,&
!   -0.002539288011493638,&
!   -0.002437314330971262,&
!   -0.002335132425933549,&
!   -0.00223275102597987,&
!   -0.002130178877752839,&
!   -0.002027424744191061,&
!   -0.001924497403780509,&
!   -0.00182140564980455,&
!   -0.001718158289592727,&
!   -0.001614764143768323,&
!   -0.001511232045494809,&
!   -0.001407570839721189,&
!   -0.001303789382426383,&
!   -0.001199896539862629,&
!   -0.001095901187798035,&
!   -0.0009918122107582851,&
!   -0.0008876385012676289,&
!   -0.0007833889590891772,&
!   -0.0006790724904645734,&
!   -0.0005746980073531188,&
!   -0.0004702744266704048,&
!   -0.0003658106695265243,&
!   -0.0002613156604639235,&
!   -0.000156798326694961,&
!   -5.22675973392336e-05,&
!   5.226759733923585e-05,&
!   0.0001567983266949583,&
!   0.0002613156604639207,&
!   0.0003658106695265216,&
!   0.000470274426670402,&
!   0.000574698007353116,&
!   0.0006790724904645706,&
!   0.0007833889590891743,&
!   0.0008876385012676261,&
!   0.0009918122107582823,&
!   0.001095901187798038,&
!   0.001199896539862631,&
!   0.001303789382426381,&
!   0.001407570839721186,&
!   0.001511232045494802,&
!   0.00161476414376832,&
!   0.001718158289592724,&
!   0.001821405649804548,&
!   0.001924497403780506,&
!   0.002027424744191058,&
!   0.002130178877752836,&
!   0.002232751025979868,&
!   0.002335132425933546,&
!   0.002437314330971264,&
!   0.00253928801149364,&
!   0.002641044755690334,&
!   0.002742575870284292,&
!   0.00284387268127444,&
!   0.002944926534676716,&
!   0.003045728797263399,&
!   0.00314627085730066,&
!   0.003246544125284286,&
!   0.003346540034673481,&
!   0.003446250042622757,&
!   0.003545665630711722,&
!   0.003644778305672856,&
!   0.003743579600117097,&
!   0.003842061073257231,&
!   0.003940214311628989,&
!   0.004038030929809852,&
!   0.004135502571135414,&
!   0.004232620908413319,&
!   0.004329377644634657,&
!   0.004425764513682809,&
!   0.004521773281039624,&
!   0.004617395744488919,&
!   0.004712623734817206,&
!   0.004807449116511606,&
!   0.004901863788454881,&
!   0.00499585968461752,&
!   0.005089428774746853,&
!   0.005182563065053078,&
!   0.00527525459889219,&
!   0.005367495457445732,&
!   0.005459277760397317,&
!   0.005550593666605852,&
!   0.005641435374775433,&
!   0.005731795124121816,&
!   0.00582166519503544,&
!   0.005911037909740931,&
!   0.005999905632953011,&
!   0.006088260772528828,&
!   0.006176095780116539,&
!   0.006263403151800194,&
!   0.006350175428740807,&
!   0.006436405197813577,&
!   0.006522085092241208,&
!   0.006607207792223276,&
!   0.006691766025561553,&
!   0.006775752568281301,&
!   0.006859160245248425,&
!   0.006941981930782466,&
!   0.00702421054926535,&
!   0.007105839075745875,&
!   0.007186860536539871]

! write(*,*) "---Fts----------------"
! !write(*,*) "u(1)"

!  do i = 1,n_time
!     d = d_list(i)
!     dpr = dpr_list(i)

!    write(*,*) Fts_attard_spatial(d, u_cur)
    
!     u_dot = compute_attard_derivative(d, dpr, u_cur)
!     u_cur = u_cur + u_dot * dt
!     !write(*,*) "u dot = ", u_dot
!     !write(*,*) Fts_attard_spatial(d, u_cur)
! !    write(*,*) u_cur(1)
!  end do
   
! end program attard_tester


    !for debugging
    subroutine assert( x, msg)
      logical :: x
      character (len=*) :: msg
      
      if (x .eqv. .FALSE. ) then
         write(6,*) "assertion failed ", msg
      end if
    end subroutine assert
